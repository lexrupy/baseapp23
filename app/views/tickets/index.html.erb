<%= content_for :header, "Listing Tickets" %>
<% content_for :sidebar do -%>
  <div class="sidebar_info">
    <p>Before submit a ticket, check if the the issue has not already been reported</p>
  </div>
  <ul class="sidebar_menu">
    <li><%= link_to_search tickets_path, :text => "View all tickets" %></li>
    <% Ticket::STATUS.each do |st| -%>
    <li><%= link_to_search tickets_path(:status => st), :text => "View #{st} tickets" %></li>
    <% end -%>
  </ul>
<% end -%>
<span style="float:left;margin-top:5px;"><%= link_to_new Ticket %></span>
<% form_tag tickets_path, :method => :get, :class => "search_form" do -%>
  <% unless params[:status].blank? -%>
    <%= hidden_field_tag "status", params[:status] %>
  <% end -%>
  <%= text_field_tag "query", params[:query] %>
  <%= submit_tag 'Search', :name => nil %>
<% end -%><br />
<table class="index">
  <tr>
    <th width="10%">#Ticket</th>
    <th width="8%">Priority</th>
    <th width="64%">Subject</th>
    <th width="10%">Category</th>
    <th width="8%">Status</th>
  </tr>
<% for ticket in @tickets %>
  <tr>
    <td><%= link_to_show ticket, :text => h(ticket.ticket_id) %></td>
    <td><%=h ticket.priority_name %></td>
    <td><%=h ticket.subject %></td>
    <td><%=h ticket.category_name %></td>
    <td style="<%= status_style(ticket) %>"><%=h ticket.status_name %></td>
  </tr>
<% end %>
</table>
<%= will_paginate @tickets %>
